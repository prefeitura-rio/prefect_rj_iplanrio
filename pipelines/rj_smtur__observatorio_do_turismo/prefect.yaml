name: rj_smtur__observatorio_do_turismo
prefect-version: 3.4.3

build:
  - prefect.deployments.steps.run_shell_script:
      id: get-commit-hash
      script: git rev-parse --short HEAD
      stream_output: false
  - prefect_docker.deployments.steps.build_docker_image:
      id: build-image
      requires: prefect-docker>=0.6.5
      image_name: ghcr.io/prefeitura-rio/prefect_rj_iplanrio/deployments
      tag: "rj_smtur__observatorio_do_turismo-{{ get-commit-hash.stdout }}"
      dockerfile: pipelines/rj_smtur__observatorio_do_turismo/Dockerfile

push:
  - prefect_docker.deployments.steps.push_docker_image:
      requires: prefect-docker>=0.6.5
      image_name: "{{ build-image.image_name }}"
      tag: "{{ build-image.tag }}"

pull:
  - prefect.deployments.steps.set_working_directory:
      directory: /opt/prefect/prefect_rj_iplanrio

deployments:
  - name: rj-smtur--observatorio_do_turismo--staging
    version: "{{ build-image.tag }}"
    entrypoint: pipelines/rj_smtur__observatorio_do_turismo/flow.py:rj_smtur__observatorio_do_turismo
    work_pool:
      name: default-pool
      work_queue_name: default
      job_variables:
        image: "{{ build-image.image_name }}:{{ build-image.tag }}"
        command: uv run --package rj_smtur__observatorio_do_turismo -- prefect flow-run execute
        secretName: prefect-jobs-secrets-staging
        image_pull_policy: Always
  - name: rj-smtur--observatorio_do_turismo--prod
    version: "{{ get-commit-hash.stdout }}"
    entrypoint: pipelines/rj_smtur__observatorio_do_turismo/flow.py:rj_smtur__observatorio_do_turismo
    work_pool:
      name: default-pool
      work_queue_name: default
      job_variables:
        image: "{{ build-image.image_name }}:{{ build-image.tag }}"
        command: uv run --package rj_smtur__observatorio_do_turismo -- prefect flow-run execute
        secretName: prefect-jobs-secrets
        image_pull_policy: Always
    schedules:
      - interval: 86400
        anchor_date: '2021-12-21T06:15:00'
        timezone: America/Sao_Paulo
        slug: museu_do_amanha
        parameters:
          table_id: museu_do_amanha
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "Museu do Amanhã"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:16:00'
        timezone: America/Sao_Paulo
        slug: cristo_redentor
        parameters:
          table_id: cristo_redentor
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "Cristo Redentor (Paineiras)"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:17:00'
        timezone: America/Sao_Paulo
        slug: bio_parque
        parameters:
          table_id: bio_parque
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "Bio Parque"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:18:00'
        timezone: America/Sao_Paulo
        slug: aquario
        parameters:
          table_id: aquario
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "AquaRio"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:19:00'
        timezone: America/Sao_Paulo
        slug: ccbb
        parameters:
          table_id: ccbb
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "CCBB"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:20:00'
        timezone: America/Sao_Paulo
        slug: iss
        parameters:
          table_id: iss
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "ISS"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:21:00'
        timezone: America/Sao_Paulo
        slug: galeao
        parameters:
          table_id: galeao
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "Galeão"
          gsheets_sheet_range: "A5:D1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:22:00'
        timezone: America/Sao_Paulo
        slug: rede_hoteleira_ocupacao_geral
        parameters:
          table_id: rede_hoteleira_ocupacao_geral
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "Ocupação da Rede Hoteleira"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:23:00'
        timezone: America/Sao_Paulo
        slug: rede_hoteleira_ocupacao_grandes_eventos
        parameters:
          table_id: rede_hoteleira_ocupacao_grandes_eventos
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "Ocupação da Rede Hoteleira em Grandes Eventos"
          gsheets_sheet_range: "A5:E1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:24:00'
        timezone: America/Sao_Paulo
        slug: santos_dumont
        parameters:
          table_id: santos_dumont
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "SDU"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:25:00'
        timezone: America/Sao_Paulo
        slug: novo_rio
        parameters:
          table_id: novo_rio
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "Novo Rio"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:26:00'
        timezone: America/Sao_Paulo
        slug: pao_de_acucar
        parameters:
          table_id: pao_de_acucar
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "Parque Bondinho - Pão de Açucar"
          gsheets_sheet_range: "A4:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:27:00'
        timezone: America/Sao_Paulo
        slug: museu_nacional
        parameters:
          table_id: museu_nacional
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "Museu Histórico Nacional"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:28:00'
        timezone: America/Sao_Paulo
        slug: museu_republica
        parameters:
          table_id: museu_republica
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "Museu da República"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:29:00'
        timezone: America/Sao_Paulo
        slug: museu_chacara_do_ceu
        parameters:
          table_id: museu_chacara_do_ceu
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "Museu Chácara do Céu"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:30:00'
        timezone: America/Sao_Paulo
        slug: museu_acude
        parameters:
          table_id: museu_acude
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "Museu do Açude"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:31:00'
        timezone: America/Sao_Paulo
        slug: museu_villa_lobos
        parameters:
          table_id: museu_villa_lobos
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "Museu Villa-Lobos"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
      - interval: 86400
        anchor_date: '2021-12-21T06:32:00'
        timezone: America/Sao_Paulo
        slug: empregos_turismo
        parameters:
          table_id: empregos_turismo
          url: "https://docs.google.com/spreadsheets/d/1qajRmbb4rvMzDW-fk_BhUGPvYkVKmr17/edit#gid=1289262407"
          url_type: google_sheet
          gsheets_sheet_name: "Empregos"
          gsheets_sheet_range: "A5:B1000"
          dump_mode: overwrite
          dataset_id: turismo_fluxo_visitantes
